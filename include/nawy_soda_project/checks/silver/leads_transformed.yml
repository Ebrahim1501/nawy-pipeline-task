checks for leads_transformed:
  - missing_count(lead_id) = 0:
      name: "lead_id cannot be null"

  - failed rows:
      name: "updated_at must be after or equal to the created timestamp"
      warn: when > 0
      fail query: |
        SELECT *
        FROM leads_transformed
        WHERE updated_at < created_at

  - failed rows:
      name: "last contact date cant be in the future"
      warn: when > 0
      fail query: |
        SELECT *
        FROM leads_transformed
        WHERE last_contact_date > NOW()::timestamp

  - failed rows:
      name: "all status names should be standardized to lowercase"
      warn: when > 0
      fail query: |
        SELECT *
        FROM leads_transformed
        WHERE status_name != LOWER(status_name)

  - failed rows:
      name: "all lead_types should be standardized to lowercase"
      warn: when > 0
      fail query: |
        SELECT *
        FROM leads_transformed
        WHERE lead_type != LOWER(lead_type)

  - invalid_count(campaign) = 0:
      name: "the value campaign ='(none)' is not valid here"
      invalid values: ['(none)']
      warn: when > 0